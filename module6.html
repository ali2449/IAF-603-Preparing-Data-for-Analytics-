<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Module 6: Joins in SQL - IAF 603</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=Source+Code+Pro:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- Highlight.js for code highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <!-- MathJax CDN -->
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <!-- Custom MathJax Configuration -->
    <script src="./js/mathjax.js"></script>
    <!-- Custom Styles -->
    <link rel="stylesheet" href="./css/styles.css">
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-light bg-light shadow-sm sticky-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="./index.html">IAF 603: Preparing Data for Analytics</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="./index.html">Home</a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            Modules
                        </a>
                        <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                            <li><a class="dropdown-item" href="./module1.html">Module 1</a></li>
                            <li><a class="dropdown-item" href="./module2.html">Module 2</a></li>
                            <li><a class="dropdown-item" href="./module3.html">Module 3</a></li>
                            <li><a class="dropdown-item" href="./module4.html">Module 4</a></li>
                            <li><a class="dropdown-item" href="./module5.html">Module 5</a></li>
                            <li><a class="dropdown-item" href="./module6.html">Module 6</a></li>
                            <li><a class="dropdown-item" href="./module7.html">Module 7</a></li>
                            <li><a class="dropdown-item" href="./module8.html">Module 8</a></li>
                            <li><a class="dropdown-item" href="./module9.html">Module 9</a></li>
                            <li><a class="dropdown-item" href="./module10.html">Module 10</a></li>
                            <li><a class="dropdown-item" href="./module11.html">Module 11</a></li>
                            <li><a class="dropdown-item" href="./module12.html">Module 12</a></li>
                            <li><a class="dropdown-item" href="./module13.html">Module 13</a></li>
                            <li><a class="dropdown-item" href="./module14.html">Module 14</a></li>
                        </ul>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="./index.html#contact">Contact</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container my-5">
        <!-- Module Title -->
        <section class="text-center py-5 bg-white rounded shadow">
            <h1 class="display-4 fw-bold text-dark">Module 6: Joins in SQL</h1>
        </section>

        <!-- Module Content -->
        <section class="my-5">
            <div class="bg-white p-4 rounded shadow">
                <!-- Learning Objectives -->
                <h2 class="h3 fw-bold border-bottom pb-2 mb-4">Learning Objectives</h2>
                <p>Upon completion of this module, participants will be able to:</p>
                <ul>
                    <li>Understand the purpose and functionality of different types of SQL joins: <code>INNER JOIN</code>, <code>LEFT JOIN</code>, <code>RIGHT JOIN</code>, <code>FULL OUTER JOIN</code>, <code>SELF JOIN</code>, and <code>CROSS JOIN</code>.</li>
                    <li>Apply joins to integrate data from multiple tables for comprehensive analysis.</li>
                    <li>Use join conditions effectively with primary and foreign keys or other matching criteria.</li>
                    <li>Combine joins with other SQL clauses (<code>WHERE</code>, <code>GROUP BY</code>, etc.) to create complex queries.</li>
                    <li>Execute join-based queries in cloud-based environments like Microsoft Fabric Lakehouse.</li>
                </ul>

                <!-- Introduction to Joins in SQL -->
                <h2 class="h3 fw-bold border-bottom pb-2 mb-4">Introduction to Joins in SQL</h2>
                <p>Joins in SQL are powerful tools for combining data from multiple tables, enabling comprehensive analysis by linking related records. This module explores the various types of joins—<code>INNER JOIN</code>, <code>LEFT JOIN</code>, <code>RIGHT JOIN</code>, <code>FULL OUTER JOIN</code>, <code>SELF JOIN</code>, and <code>CROSS JOIN</code>—and their applications in data preparation. Joins are essential in real-world scenarios, such as combining patient demographics with admission records in healthcare or linking customer data with orders in retail. By mastering joins, you can create holistic datasets for analytics, ensuring all relevant information is integrated efficiently.</p>
                <p>In practice, joins allow you to answer complex questions. For example, in a Greensboro hospital, you might join patient and admission tables to analyze treatment patterns. In a retail context, joining customer and order tables can reveal purchasing trends. Understanding join types and their impact on result sets is critical for avoiding data loss or duplication.</p>

                <!-- Types of Joins -->
                <h3 class="h4 fw-bold mb-3">Types of Joins</h3>
                <p>SQL joins combine rows from two or more tables based on a condition, typically involving primary and foreign keys. Each join type determines which rows are included in the result set.</p>
                <ul>
                    <li><strong>INNER JOIN:</strong> Returns only rows where there is a match in both tables.</li>
                    <li><strong>LEFT JOIN (LEFT OUTER JOIN):</strong> Returns all rows from the left table and matched rows from the right; unmatched rows from the right get NULL values.</li>
                    <li><strong>RIGHT JOIN (RIGHT OUTER JOIN):</strong> Returns all rows from the right table and matched rows from the left; unmatched rows from the left get NULL values.</li>
                    <li><strong>FULL OUTER JOIN:</strong> Returns all rows from both tables, with NULLs for unmatched rows.</li>
                    <li><strong>SELF JOIN:</strong> Joins a table to itself, useful for hierarchical or self-referential data.</li>
                    <li><strong>CROSS JOIN:</strong> Produces a Cartesian product, combining every row from one table with every row from another.</li>
                </ul>

                <!-- Sample Data -->
                <h4 class="h5 fw-bold mb-2">Sample Data</h4>
                <p><strong>PATIENTS Table:</strong></p>
                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th>subject_id</th>
                            <th>name</th>
                            <th>age</th>
                            <th>gender</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>1001</td>
                            <td>Alice Smith</td>
                            <td>45</td>
                            <td>Female</td>
                        </tr>
                        <tr>
                            <td>1002</td>
                            <td>Bob Johnson</td>
                            <td>32</td>
                            <td>Male</td>
                        </tr>
                        <tr>
                            <td>1003</td>
                            <td>Carol White</td>
                            <td>58</td>
                            <td>Female</td>
                        </tr>
                        <tr>
                            <td>1004</td>
                            <td>David Brown</td>
                            <td>67</td>
                            <td>Male</td>
                        </tr>
                    </tbody>
                </table>
                <p><strong>ADMISSIONS Table:</strong></p>
                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th>hadm_id</th>
                            <th>subject_id</th>
                            <th>admit_time</th>
                            <th>diagnosis</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>101</td>
                            <td>1001</td>
                            <td>2025-01-10 08:00:00</td>
                            <td>Pneumonia</td>
                        </tr>
                        <tr>
                            <td>102</td>
                            <td>1002</td>
                            <td>2025-02-01 14:00:00</td>
                            <td>Fracture</td>
                        </tr>
                        <tr>
                            <td>103</td>
                            <td>1001</td>
                            <td>2025-03-05 10:00:00</td>
                            <td>Pneumonia</td>
                        </tr>
                        <tr>
                            <td>104</td>
                            <td>1005</td>
                            <td>2025-04-10 07:00:00</td>
                            <td>Flu</td>
                        </tr>
                    </tbody>
                </table>

                <!-- INNER JOIN -->
                <h4 class="h5 fw-bold mb-2">INNER JOIN</h4>
                <p><code>INNER JOIN</code> retrieves only the rows with matching values in both tables, excluding unmatched rows.</p>
                <div class="code-block">
                    <button class="btn btn-sm btn-secondary copy-btn" onclick="copyCode(this)">Copy</button>
                    <pre><code class="language-sql">-- Match patients with their admissions
SELECT p.name, p.age, a.hadm_id, a.diagnosis
FROM PATIENTS p
INNER JOIN ADMISSIONS a ON p.subject_id = a.subject_id;</code></pre>
                </div>
                <p><strong>Explanation:</strong> This query returns only patients with admissions, linking via <code>subject_id</code>. Patient 1004 and admission for 1005 are excluded since they lack matches.</p>
                <p><strong>Expanded Example (Retail):</strong></p>
                <p><strong>Customers Table:</strong></p>
                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th>customer_id</th>
                            <th>name</th>
                            <th>email</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>1</td>
                            <td>John Doe</td>
                            <td>john@example.com</td>
                        </tr>
                        <tr>
                            <td>2</td>
                            <td>Jane Smith</td>
                            <td>jane@example.com</td>
                        </tr>
                        <tr>
                            <td>3</td>
                            <td>Mike Lee</td>
                            <td>mike@example.com</td>
                        </tr>
                    </tbody>
                </table>
                <p><strong>Orders Table:</strong></p>
                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th>order_id</th>
                            <th>customer_id</th>
                            <th>order_date</th>
                            <th>total</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>101</td>
                            <td>1</td>
                            <td>2025-01-15</td>
                            <td>150.00</td>
                        </tr>
                        <tr>
                            <td>102</td>
                            <td>2</td>
                            <td>2025-02-20</td>
                            <td>300.00</td>
                        </tr>
                        <tr>
                            <td>103</td>
                            <td>4</td>
                            <td>2025-03-10</td>
                            <td>200.00</td>
                        </tr>
                    </tbody>
                </table>
                <div class="code-block">
                    <button class="btn btn-sm btn-secondary copy-btn" onclick="copyCode(this)">Copy</button>
                    <pre><code class="language-sql">-- Customers with orders
SELECT c.name, c.email, o.order_id, o.total
FROM Customers c
INNER JOIN Orders o ON c.customer_id = o.customer_id;</code></pre>
                </div>
                <p><strong>Explanation:</strong> Returns only customers with orders, excluding Mike Lee and order 103 (no matching customer).</p>

                <!-- LEFT JOIN -->
                <h4 class="h5 fw-bold mb-2">LEFT JOIN</h4>
                <p><code>LEFT JOIN</code> includes all rows from the left table, with NULLs for unmatched rows from the right table.</p>
                <div class="code-block">
                    <button class="btn btn-sm btn-secondary copy-btn" onclick="copyCode(this)">Copy</button>
                    <pre><code class="language-sql">-- All patients, including those without admissions
SELECT p.name, p.age, a.hadm_id, a.diagnosis
FROM PATIENTS p
LEFT JOIN ADMISSIONS a ON p.subject_id = a.subject_id;</code></pre>
                </div>
                <p><strong>Explanation:</strong> Includes all patients, with NULLs for David Brown (no admissions). Useful for identifying patients without hospital stays.</p>
                <p><strong>Expanded Example (Retail):</strong></p>
                <div class="code-block">
                    <button class="btn btn-sm btn-secondary copy-btn" onclick="copyCode(this)">Copy</button>
                    <pre><code class="language-sql">-- All customers, including those without orders
SELECT c.name, c.email, o.order_id, o.total
FROM Customers c
LEFT JOIN Orders o ON c.customer_id = o.customer_id;</code></pre>
                </div>
                <p><strong>Explanation:</strong> Lists all customers, with NULLs for Mike Lee’s orders, helping identify inactive customers.</p>

                <!-- RIGHT JOIN -->
                <h4 class="h5 fw-bold mb-2">RIGHT JOIN</h4>
                <p><code>RIGHT JOIN</code> includes all rows from the right table, with NULLs for unmatched rows from the left table.</p>
                <div class="code-block">
                    <button class="btn btn-sm btn-secondary copy-btn" onclick="copyCode(this)">Copy</button>
                    <pre><code class="language-sql">-- All admissions, including unmatched patient IDs
SELECT p.name, p.age, a.hadm_id, a.diagnosis
FROM PATIENTS p
RIGHT JOIN ADMISSIONS a ON p.subject_id = a.subject_id;</code></pre>
                </div>
                <p><strong>Explanation:</strong> Includes all admissions, with NULLs for patient 1005’s details, useful for auditing unmatched records.</p>
                <p><strong>Expanded Example (Retail):</strong></p>
                <div class="code-block">
                    <button class="btn btn-sm btn-secondary copy-btn" onclick="copyCode(this)">Copy</button>
                    <pre><code class="language-sql">-- All orders, including unmatched customers
SELECT c.name, c.email, o.order_id, o.total
FROM Customers c
RIGHT JOIN Orders o ON c.customer_id = o.customer_id;</code></pre>
                </div>
                <p><strong>Explanation:</strong> Includes all orders, with NULLs for customer 4, flagging potential data issues.</p>

                <!-- FULL OUTER JOIN -->
                <h4 class="h5 fw-bold mb-2">FULL OUTER JOIN</h4>
                <p><code>FULL OUTER JOIN</code> includes all rows from both tables, with NULLs for unmatched rows.</p>
                <div class="code-block">
                    <button class="btn btn-sm btn-secondary copy-btn" onclick="copyCode(this)">Copy</button>
                    <pre><code class="language-sql">-- All patients and admissions, including unmatched
SELECT p.name, p.age, a.hadm_id, a.diagnosis
FROM PATIENTS p
FULL OUTER JOIN ADMISSIONS a ON p.subject_id = a.subject_id;</code></pre>
                </div>
                <p><strong>Explanation:</strong> Includes all patients and admissions, with NULLs for unmatched records (e.g., David Brown and patient 1005).</p>
                <p><strong>Expanded Example (Retail):</strong></p>
                <div class="code-block">
                    <button class="btn btn-sm btn-secondary copy-btn" onclick="copyCode(this)">Copy</button>
                    <pre><code class="language-sql">-- All customers and orders, including unmatched
SELECT c.name, c.email, o.order_id, o.total
FROM Customers c
FULL OUTER JOIN Orders o ON c.customer_id = o.customer_id;</code></pre>
                </div>
                <p><strong>Explanation:</strong> Captures all customers and orders, highlighting data gaps for analysis.</p>

                <!-- SELF JOIN -->
                <h4 class="h5 fw-bold mb-2">SELF JOIN</h4>
                <p>A <code>SELF JOIN</code> joins a table to itself, useful for hierarchical or comparative data.</p>
                <p><strong>Employees Table (with Manager):</strong></p>
                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th>emp_id</th>
                            <th>name</th>
                            <th>manager_id</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>1</td>
                            <td>John Doe</td>
                            <td>NULL</td>
                        </tr>
                        <tr>
                            <td>2</td>
                            <td>Jane Smith</td>
                            <td>1</td>
                        </tr>
                        <tr>
                            <td>3</td>
                            <td>Mike Johnson</td>
                            <td>1</td>
                        </tr>
                    </tbody>
                </table>
                <div class="code-block">
                    <button class="btn btn-sm btn-secondary copy-btn" onclick="copyCode(this)">Copy</button>
                    <pre><code class="language-sql">-- Employees and their managers
SELECT e1.name AS Employee, e2.name AS Manager
FROM Employees e1
LEFT JOIN Employees e2 ON e1.manager_id = e2.emp_id;</code></pre>
                </div>
                <p><strong>Explanation:</strong> Links employees to their managers using aliases, showing hierarchical relationships.</p>

                <!-- CROSS JOIN -->
                <h4 class="h5 fw-bold mb-2">CROSS JOIN</h4>
                <p><code>CROSS JOIN</code> combines every row from one table with every row from another, creating a Cartesian product.</p>
                <div class="code-block">
                    <button class="btn btn-sm btn-secondary copy-btn" onclick="copyCode(this)">Copy</button>
                    <pre><code class="language-sql">-- All possible patient-diagnosis combinations
SELECT p.name, a.diagnosis
FROM PATIENTS p
CROSS JOIN ADMISSIONS a;</code></pre>
                </div>
                <p><strong>Explanation:</strong> Produces all combinations, useful for testing or scenarios requiring exhaustive pairings.</p>

                <!-- Combining Joins with Other Clauses -->
                <h3 class="h4 fw-bold mb-3">Combining Joins with Other Clauses</h3>
                <p>Joins work with <code>WHERE</code>, <code>GROUP BY</code>, and <code>ORDER BY</code> for complex queries.</p>
                <div class="code-block">
                    <button class="btn btn-sm btn-secondary copy-btn" onclick="copyCode(this)">Copy</button>
                    <pre><code class="language-sql">-- Count admissions per patient for Pneumonia in 2025
SELECT p.name, COUNT(a.hadm_id) AS AdmissionCount
FROM PATIENTS p
INNER JOIN ADMISSIONS a ON p.subject_id = a.subject_id
WHERE a.diagnosis = 'Pneumonia' AND EXTRACT(YEAR FROM a.admit_time) = 2025
GROUP BY p.name
ORDER BY AdmissionCount DESC;</code></pre>
                </div>
                <p><strong>Explanation:</strong> Joins patients and admissions, filters for Pneumonia in 2025, groups by patient, and sorts by admission count.</p>
                <p><strong>Expanded Example (Retail):</strong></p>
                <div class="code-block">
                    <button class="btn btn-sm btn-secondary copy-btn" onclick="copyCode(this)">Copy</button>
                    <pre><code class="language-sql">-- Total order value by customer for orders > $200
SELECT c.name, SUM(o.total) AS TotalSpent
FROM Customers c
LEFT JOIN Orders o ON c.customer_id = o.customer_id
WHERE o.total > 200 OR o.total IS NULL
GROUP BY c.name
HAVING SUM(o.total) > 200
ORDER BY TotalSpent DESC;</code></pre>
                </div>
                <p><strong>Explanation:</strong> Identifies high-spending customers, including those without orders, with filtering and aggregation.</p>

                <!-- Joins in Microsoft Fabric -->
                <h3 class="h4 fw-bold mb-3">Joins in Microsoft Fabric Lakehouse</h3>
                <p>Microsoft Fabric supports joins on large-scale data, leveraging distributed computing.</p>
                <div class="code-block">
                    <button class="btn btn-sm btn-secondary copy-btn" onclick="copyCode(this)">Copy</button>
                    <pre><code class="language-sql">-- Join survey responses with demographics
SELECT d.respondent_id, d.age, r.satisfaction_score
FROM survey_lakehouse.Demographics d
INNER JOIN survey_lakehouse.Responses r ON d.respondent_id = r.respondent_id
WHERE r.response_date >= '2025-01-01';</code></pre>
                </div>
                <p><strong>Explanation:</strong> Combines demographic and survey data for recent responses, optimized for big data.</p>

                <!-- Assessments -->
                <h2 class="h3 fw-bold border-bottom pb-2 mb-4">Assessments</h2>
                <ol>
                    <li><strong>Conceptual Question:</strong> Explain the difference between <code>INNER JOIN</code> and <code>LEFT JOIN</code>. When would you use each?</li>
                    <li><strong>SQL Coding Task:</strong> Using the PATIENTS and ADMISSIONS tables, write a query to list all patients and their admission diagnoses, including patients without admissions, sorted by name.</li>
                    <li><strong>Application Scenario:</strong> For a Greensboro library, join Books and Loans tables to find all books and their loan status, including unborrowed books.</li>
                    <li><strong>Expanded Task:</strong> For a university database, join Students and Enrollments tables to list students and their courses, including students not enrolled, and count enrollments per student.</li>
                </ol>
            </div>
        </section>
    </div>

    <!-- Footer -->
    <footer class="bg-light py-3 text-center">
        <p class="text-muted mb-0">&copy; 2025 Ali Noori, UNCG. All rights reserved.</p>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN" crossorigin="anonymous"></script>
    <!-- Highlight.js Initialization -->
    <script>hljs.highlightAll();</script>
    <!-- Custom Copy Functionality -->
    <script>
        function copyCode(button) {
            const code = button.nextElementSibling.querySelector('code');
            navigator.clipboard.writeText(code.innerText).then(() => {
                button.textContent = 'Copied!';
                setTimeout(() => { button.textContent = 'Copy'; }, 2000);
            });
        }
    </script>
</body>
</html>